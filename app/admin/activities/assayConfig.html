<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-sm-4">
        <h2>{{vm.assay.isNew ? 'New Assay' :'Assay detail'}}</h2>
        <ol class="breadcrumb">
            <li>
                <a ui-sref="main.home">Home</a>
            </li>
            <li>
                <a ui-sref="admin.project({projectId:vm.projectId})">{{vm.projectId}}</a>
            </li>
            <li class="active">
                <a>{{vm.assay.isNew ? 'New Assay' : vm.assay.name}}</a>
            </li>
        </ol>
    </div>
    <div class="col-sm-8">
        <div class="title-action">
            <a ng-click="vm.saveAssay()" class="btn btn-primary">Save</a>
            <a ng-click="vm.dontSaveAssay()" class="btn btn-primary">Cancel</a>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="wrapper wrapper-content animated fadeInRight">
            <div class="ibox">
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-md-12">
                            <dl class="dl-horizontal">
                                <dt>Assay Configuration</dt>
                                <dd>
                                    <div class="col-md-6">
                                        <a href="#" e-ng-model="vm.assay.name" editable-text="vm.assay.name" buttons="no" blur="submit">{{vm.assay.name || "Unnamed"}}</a>
                                    </div>
                                </dd>
                            </dl>
                        </div>
                    </div>
                    <div class="row">

                        <div class="col-md-6">

                            <dl class="dl-horizontal">


                                <dt>Measurement Type</dt>
                                <dd>
                                    <div>
                                        <select class="form-control m-b" name="activitySelect" id="assayMeasType"
                                                ng-model="vm.assay.type" ng-change="vm.updateAssayTerms()">
                                            <option ng-repeat="option in vm.assayTypes" value="{{option.assayTypeTerm.id}}">{{option.assayTypeTerm.name}}</option>
                                        </select>
                                    </div>
                                </dd>
                                <dt>Design Type</dt>
                                <dd>
                                    <div>
                                        <select class="form-control m-b" name="activitySelect" id="assayDesignType"
                                                ng-model="vm.assay.design" >
                                            <option ng-repeat="option in vm.assayDesigns" value="{{option.id}}">{{option.name}}</option>
                                        </select>
                                    </div>
                                </dd>
                            </dl>
                        </div>
                        <div class="col-md-6">
                            <dl class="dl-horizontal">

                                <dt>Technology Type</dt>
                                <dd>
                                    <div>
                                        <select class="form-control m-b" name="activitySelect" id="assayTechSelect"
                                                data-ng-model="vm.assay.technology">
                                            <option ng-repeat="option in vm.assayTechTerms" value="{{option.id}}">{{option.name}}</option>
                                        </select>
                                    </div>
                                </dd>

                                <dt>Technology Platform</dt>
                                <dd>
                                    <div>
                                        <select class="form-control m-b" name="activitySelect" id="assayPlatSelect"
                                                data-ng-model="vm.assay.platform">
                                            <option ng-repeat="option in vm.assayPlatTerms" value="{{option.id}}">{{option.name}}</option>
                                        </select>
                                    </div>
                                </dd>
                            </dl>
                        </div>
                    </div>
                    <!-- <div class="row">
                        <div class="col-lg-5">
                            <dl class="dl-horizontal">

                                <dt>Created by:</dt>
                                <dd>Ibrahim Emam</dd>
                                <dt>Subjects:</dt>
                                <dd> <a href="#" e-ng-model="vmodel.activity.size" editable-text="vm.activity.size" buttons="no" blur="submit">{{vm.activity.size || "Expected No. of subjects"}}</a></dd>
                                <dt>Client:</dt>
                                <dd><a href="" class="text-navy"> Zender Company</a></dd>
                                <dt>Version:</dt>
                                <dd> v1.4.2</dd>
                            </dl>
                        </div>
                        &lt;!&ndash;<div ng-if="!vm.activity.isNew" class="col-lg-7" id="cluster_info">
                            <dl class="dl-horizontal">

                                <dt>Last Updated:</dt>
                                <dd>16.08.2014 12:15:57</dd>
                                <dt>Created:</dt>
                                <dd> 10.07.2014 23:36:57</dd>

                            </dl>
                        </div>&ndash;&gt;
                    </div>-->
                    <!--<div class="row" ng-if="!vm.activity.isNew">
                        <div class="col-lg-12">
                            <dl class="dl-horizontal">
                                <dt>Completed:</dt>
                                <dd>
                                    <div class="progress progress-striped m-b-sm">
                                        <div style="width: 60%;" class="progress-bar"></div>
                                    </div>
                                    &lt;!&ndash; <small>Project completed in <strong>60%</strong>. Remaining close the project, sign a contract and invoice.</small>&ndash;&gt;
                                </dd>
                            </dl>
                        </div>
                    </div>-->
                </div>
            </div>

            <div class="ibox">
                <div class="ibox-title panel-header">
                    <span>Associated Templates</span>
                </div>

                <uib-tabset class="tab-panel">
                    <!--SAMPLE ANNOTATION TAB-->
                    <uib-tab>
                        <uib-tab-heading class="assay-info" align="center">
                            <p class="tab-info">Sample Annotation Template</p>

                            <p class="assay-count">
                                    {{ vm.assay.samplesDataset.name || 'No Template Selected' }}
                            </p>

                            <p class="tab-info text-left" >
                                A template for loading sample data such as sample characteristics, timepoints, replicates and subject to sample mapping
                            </p>
                        </uib-tab-heading>

                        <div id="sampleTemplate" class="animated fadeIn">

                                <!--CONTROLS-->
                                <div class="border-bottom p-w-sm text-right" style="margin: 0px -15px;">
                                    <span style="font-size:16px;margin-top:-5px;">
                                        <i class="p-xs fa fa-eye"> </i><i class="p-xs fa fa-download"> </i>
                                        <a ng-click="vm.deleteDS()"><i class="p-xs fa fa-trash"> </i></a>
                                        <a ng-init="vm.showSampleTemplates = false" ng-click="vm.showSampleTemplates = !vm.showSampleTemplates;vm.loadAssaySampleTemplates()">
                                            <i uib-tooltip="Add Dataset" class="p-xs fa fa-edit"></i>
                                        </a>
                                    </span>
                                </div>

                                <!--Choose Template-->
                                <div uib-collapse="!vm.showSampleTemplates" class="ibox-content" style="min-height: 250px;margin: 0px -15px; background-color: rgb(243, 243, 244);">
                                    <div class="row">
                                            <div class="col-md-11">
                                                <h3>{{vm.assay.samplesDataset ? 'Change Template':'Choose Template'}}</h3>
                                            </div>
                                            <div class="col-md-1"> <span class="pull-right"><a ng-click="vm.showSampleTemplates=false" class="btn btn-white btn-lg"><i class="fa fa-times"></i></a> </span></div>
                                        </div>
                                    <div class="row">
                                            <div class="col-md-7">
                                                <div class="row m-b-sm m-t-sm">
                                                    <div class="col-md-12">
                                                        <input ng-model="searchTemplate" type="text" placeholder="Search" class="input-sm form-control">
                                                    </div>
                                                </div>

                                                <div class="ibox-content">
                                                    <div class="activities-list" full-scroll>
                                                        <div class="full-height-scroll">
                                                            <div class="feed-activity-list elements-list">
                                                                <div class="feed-element" ng-repeat="ds in vm.templates.sample | filter:{name: searchTemplate}">
                                                                    <a ng-click="vm.previewSampleTemplate = ds">
                                                                        <div>
                                                                            <small class="pull-right text-navy">{{ds.class}}</small>
                                                                            <strong>{{ds.name}} - ({{ds.code}})</strong>
                                                                            <div>{{ds.description}}</div>
                                                                            <small class="text-muted"><strong>Structure: </strong>{{ds.structure}}</small>
                                                                        </div>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!--FIELD INFO-->
                                            <div ng-show="vm.previewSampleTemplate" style="border-left: white 1px solid;" class=" m-b-sm m-t-sm col-md-5">
                                                <div class="ibox-title">
                                                    <strong>{{vm.previewSampleTemplate.name}} Template Fields</strong>
                                                    <span class="pull-right">
                                                        <a ng-click="vm.setSamplesDS(vm.previewSampleTemplate);vm.showSampleTemplates=false" class="btn btn-xs btn-primary">Choose Template</a>
                                                    </span>
                                                </div>
                                                <div class="ibox-content">
                                                    <div class="activities-list" full-scroll>
                                                        <div class="full-height-scroll">
                                                            <table class="table table-hover no-margins">
                                                                <thead>
                                                                <tr>
                                                                    <th>Column</th>
                                                                    <th>Name</th>
                                                                    <th>Description</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <tr ng-repeat="var in vm.previewSampleTemplate.variables">
                                                                    <td class="text-navy">
                                                                        <small>{{var.name}}</small>
                                                                    </td>
                                                                    <td>{{var.label}}</td>
                                                                    <td >{{var.description}}</td>
                                                                </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                </div>

                                <div ng-hide="vm.assay.samplesDataset" class="ibox-content ibox-heading">
                                    <h3>No Template Selected</h3>
                                </div>

                                <!--SUMMARY DATA-->
                                <div class=" m-b-sm m-t-sm border-bottom" ng-show="vm.assay.samplesDataset">
                                    <dl class="dl-horizontal">
                                                    <dt>Class</dt>
                                                    <dd>{{vm.assay.samplesDataset.class}}</dd>
                                                    <dt>Description</dt>
                                                    <dd>{{vm.assay.samplesDataset.description}}</dd>
                                                    <dt>Structure</dt>
                                                    <dd>{{vm.assay.samplesDataset.structure}}</dd>
                                                </dl>
                                </div>

                                <!--VARIABLES TABLE-->
                                <div  ng-show="vm.assay.samplesDataset">
                                    <div class="ibox-title">
                                            <h5>Select columns to include in this template</h5>
                                        </div>
                                    <div class="ibox-content">
                                            <!--FOO TABLE-->
                                            <table id="bs_template_tbl" class="footable table table-stripped toggle-arrow-tiny" load-when="vm.loaded" data-page-size="15">
                                                <thead>

                                                    <tr>
                                                        <th data-toggle="true">Column</th>
                                                        <th>Variable Name</th>
                                                        <th>Include</th>
                                                        <th data-group="group1" data-hide="phone">Mandatory</th>
                                                        <th data-group="group1" data-hide="all">Description</th>
                                                        <th data-hide="all">Controlled Vocabulary</th>
                                                        <th data-hide="all">Order</th>
                                                        <th data-hide="all">Key Sequence</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="var in vm.selectedDatasets['sample'].variables">
                                                        <td>
                                                            {{var.name}}
                                                        </td>
                                                        <td>
                                                            {{var.label}}
                                                        </td>
                                                        <td>
                                                            <!--<button type="button" class="btn btn-xs btn-primary" ng-model="var.isSelected" btn-checkbox>
                                                                {{var.isSelected ? 'Included' : 'Excluded'}}
                                                            </button>-->
                                                            <input  icheck type="checkbox"  ng-model="var.isSelected" >
                                                        </td>
                                                        <td>
                                                            <input  icheck type="checkbox"  ng-model="var.isRequired" >
                                                        </td>
                                                        <td>
                                                            {{var.description}}
                                                        </td>
                                                        <td>
                                                            {{var.dictionaryName}}
                                                        </td>
                                                        <td>
                                                            <a href="#" e-ng-model="var.order" editable-text="var.order" buttons="no" blur="submit">{{var.order || "Undefined"}}</a>
                                                        </td>
                                                        <td>
                                                            <a href="#" e-ng-model="var.sequence" editable-text="var.sequence" buttons="no" blur="submit">{{var.sequence || "Undefined"}}</a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <td colspan="6">
                                                            <ul class="pagination pull-right"></ul>
                                                        </td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                </div>

                            </div>
                    </uib-tab>

                    <!--FEATURE ANNOTATION TAB-->
                    <uib-tab class="odd">
                        <uib-tab-heading class="assay-info" align="center">
                            <p class="tab-info">
                                Feature Annotation Template
                            </p>
                            <p class="assay-count">
                                {{ vm.assay.featuresDataset.name || 'No Template Selected' }}
                            </p>
                            <p class="tab-info text-left">
                                A template for loading feature metadata such as gene names, chromosome location and probset to gene mapping
                            </p>
                        </uib-tab-heading>

                        <div id="featureTemplate" class="animated fadeIn">

                            <!--CONTROLS-->
                            <div class="border-bottom p-w-sm text-right" style="margin: 0px -15px;">
                                    <span style="font-size:16px;margin-top:-5px;">
                                        <i class="p-xs fa fa-eye"> </i><i class="p-xs fa fa-download"> </i>
                                        <a ng-click="vm.deleteDS()"><i class="p-xs fa fa-trash"> </i></a>
                                        <a ng-init="vm.showFeatureTemplates = false" ng-click="vm.showFeatureTemplates = !vm.showFeatureTemplates;vm.loadAssayFeatureTemplates()">
                                            <i uib-tooltip="Add Dataset" class="p-xs fa fa-edit"></i>
                                        </a>
                                    </span>
                            </div>

                            <!--Choose Template-->
                            <div uib-collapse="!vm.showFeatureTemplates" class="ibox-content" style="min-height: 250px;margin: 0px -15px; background-color: rgb(243, 243, 244);">
                                <div class="row">
                                    <div class="col-md-11">
                                        <h3>{{vm.assay.featuresDataset ? 'Change Template':'Choose Template'}}</h3>
                                    </div>
                                    <div class="col-md-1"> <span class="pull-right"><a ng-click="vm.showFeatureTemplates=false" class="btn btn-white btn-lg"><i class="fa fa-times"></i></a> </span></div>
                                </div>
                                <div class="row">
                                    <div class="col-md-7">
                                        <div class="row m-b-sm m-t-sm">

                                            <div class="col-md-12">
                                                <input ng-model="searchTemplate" type="text" placeholder="Search" class="input-sm form-control">
                                            </div>
                                        </div>

                                        <div class="ibox-content">
                                            <div class="activities-list" full-scroll>
                                                <div class="full-height-scroll">
                                                    <div class="feed-activity-list elements-list">
                                                        <div class="feed-element" ng-repeat="ds in vm.templates.feature | filter:{name: searchTemplate}">
                                                            <a ng-click="vm.previewFeatureTemplate = ds">
                                                                <div>
                                                                    <small class="pull-right text-navy">{{ds.class}}</small>
                                                                    <strong>{{ds.name}} - ({{ds.code}})</strong>
                                                                    <div>{{ds.description}}</div>
                                                                    <small class="text-muted"><strong>Structure: </strong>{{ds.structure}}</small>
                                                                </div>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!--FIELD INFO-->
                                    <div ng-show="vm.previewFeatureTemplate" style="border-left: white 1px solid;" class=" m-b-sm m-t-sm col-md-5">
                                        <div class="ibox-title"><strong>{{vm.previewFeatureTemplate.name}} Template Fields</strong>
                                            <span class="pull-right"><a ng-click="vm.setFeaturesDS(vm.previewFeatureTemplate);vm.showFeatureTemplates=false" class="btn btn-xs btn-primary">Choose Template</a></span>
                                        </div>
                                        <div class="ibox-content">
                                            <div class="activities-list" full-scroll>
                                                <div class="full-height-scroll">
                                                    <table class="table table-hover no-margins">
                                                        <thead>
                                                        <tr>
                                                            <th>Column</th>
                                                            <th>Name</th>
                                                            <th>Description</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        <tr ng-repeat="var in vm.previewFeatureTemplate.variables">
                                                            <td class="text-navy">
                                                                <small>{{var.name}}</small>
                                                            </td>
                                                            <td>{{var.label}}</td>
                                                            <td >{{var.description}}</td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--No Template Info-->
                            <div ng-hide="vm.assay.featuresDataset" class="ibox-content ibox-heading">
                                <h3>No Template Selected</h3>
                            </div>

                            <!--SUMMARY DATA-->
                            <div class=" m-b-sm m-t-sm border-bottom" ng-show="vm.assay.featuresDataset">
                                <dl class="dl-horizontal">
                                    <dt>Class</dt>
                                    <dd>{{vm.assay.featuresDataset.class}}</dd>
                                    <dt>Description</dt>
                                    <dd>{{vm.assay.featuresDataset.description}}</dd>
                                    <dt>Structure</dt>
                                    <dd>{{vm.assay.featuresDataset.structure}}</dd>
                                </dl>
                            </div>

                            <!--DATASET VARIABLES-->
                            <div  ng-show="vm.assay.featuresDataset">
                                <div class="ibox-title">
                                    <h5>Select columns to include in this template</h5>
                                </div>

                                <div class="ibox-content">
                                    <!--HEADER SECTION-->
                                    <div ng-if="vm.assay.featuresDataset.hasHeader" class="ibox-title panel-header">
                                        <span style="display: inline-block">Header Fields</span>
                                        <div class="plotting-switch" style="display: inline-block;float:right;padding: 5px;">
                                            Include
                                            <a class="switchery" id="sc_" style="color: rgb(34, 47, 63);"
                                               ng-init="vm.assay.featuresDataset.IsHeaderIncluded ? vm.showHeaderFields = true : vm.showHeaderFields = false"
                                               ng-class="{on:vm.showHeaderFields}"
                                               ng-click="vm.showHeaderFields = !vm.showHeaderFields;">
                                                <small></small>
                                            </a>
                                        </div>
                                    </div>

                                    <div uib-collapse="!vm.showHeaderFields">

                                        <!--FOO TABLE-->
                                        <table id="fe_template_tbl2" class="footable table table-stripped toggle-arrow-tiny" load-when="vm.loaded" data-page-size="15">
                                            <thead>
                                            <tr>
                                                <th data-toggle="true">Column</th>
                                                <th>Variable Name</th>
                                                <th>Include</th>
                                                <th data-hide="phone">Mandatory</th>
                                                <th data-hide="all">Description</th>
                                                <th data-hide="all">Controlled Vocabulary</th>
                                                <th data-hide="all">Order</th>
                                                <th data-hide="all">Key Sequence</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="var in vm.assay.featuresDataset.headerFields">
                                                <td>
                                                    {{var.name}}
                                                </td>
                                                <td>
                                                    {{var.label}}
                                                </td>
                                                <td>
                                                    <!--<button type="button" class="btn btn-xs btn-primary" ng-model="var.isSelected" btn-checkbox>
                                                        {{var.isSelected ? 'Included' : 'Excluded'}}
                                                    </button>-->
                                                    <input  icheck type="checkbox"  ng-model="var.isSelected" >
                                                </td>
                                                <td>
                                                    <input  icheck type="checkbox"  ng-model="var.isRequired" >
                                                </td>
                                                <td>
                                                    {{var.description}}
                                                </td>
                                                <td>
                                                    {{var.dictionaryName}}
                                                </td>
                                                <td>
                                                    <a href="#" e-ng-model="var.order" editable-text="var.order" buttons="no" blur="submit">{{var.order || "Undefined"}}</a>
                                                    <!--<input class="input-sm" style="width:25px" type="text" ng-model="var.order">-->
                                                </td>
                                                <td>
                                                    <a href="#" e-ng-model="var.sequence" editable-text="var.sequence" buttons="no" blur="submit">{{var.sequence || "Undefined"}}</a>
                                                    <!--<input class="input-sm" style="width:25px" type="text" ng-model="var.sequence">-->
                                                </td>
                                            </tr>
                                            </tbody>
                                            <tfoot>
                                            <tr>
                                                <td colspan="6">
                                                    <ul class="pagination pull-right"></ul>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        </table>
                                    </div>

                                    <!--TABLE SECTION-->
                                    <div class="ibox-title panel-header m-t-md">
                                        <span style="display: inline-block">Table Fields</span>
                                        <span style="font-size:16px;margin-top:-9px;" class="pull-right">
                                            <a ng-init="vm.addingNewField = false" ng-click="vm.addingNewField = !vm.addingNewField">
                                                <i uib-tooltip="Add New Fields" class="p-xs fa" ng-class="!vm.addingNewField ? 'fa-plus' : 'fa-times'"></i>
                                            </a>
                                        </span>
                                    </div>

                                    <div uib-collapse="!vm.addingNewField" class="ibox-content m-sm" style="min-height: 150px;border: 0px solid white;background-color: rgb(243, 243, 244);">
                                        <form role="form">

                                            <h3>Add New Field</h3>
                                            <div class="row m-t-md ">
                                                <div class="col-md-5 ">
                                                    <div class="form-group">
                                                        <label class="m-t-xs col-md-1 control-label pull-left">Name</label>
                                                        <div class="col-md-11">
                                                            <ui-select ng-model="vm.assay.featuresDataset.newField" theme="bootstrap">
                                                                <ui-select-match placeholder="Select a field to add to the template">
                                                                    {{$select.selected.name}}
                                                                </ui-select-match>
                                                                <ui-select-choices repeat="item in vm.assay.featuresDataset.genericFields | filter: $select.search">
                                                                    <div ng-bind-html="item.name | highlight: $select.search"></div>
                                                                </ui-select-choices>
                                                            </ui-select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-5" ng-if="vm.assay.featuresDataset.newField">
                                                    <div class="form-group">
                                                        <label class="m-t-xs col-md-2 control-label pull-left">Qualifier</label>
                                                        <div class="col-md-10">
                                                            <ui-select tagging multiple limit="1" ng-model="vm.assay.featuresDataset.newFieldQualifier" theme="bootstrap">
                                                                <ui-select-match placeholder="Select a field to add to the template">
                                                                    {{$item}}
                                                                </ui-select-match>
                                                                <ui-select-choices repeat="item in vm.assay.featuresDataset.newField.allowedQualifiers | filter: $select.search">
                                                                    <div ng-bind-html="item | highlight: $select.search"></div>
                                                                </ui-select-choices>
                                                            </ui-select>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="row m-t-md" >
                                                <div class="col-md-12">
                                                    <div class="col-md-2"><label>Column to be added:</label> </div>
                                                    <div ng-if="vm.assay.featuresDataset.newFieldQualifier" class="col-md-5" style="color: #dd7a2a;font-size: 1.3em">
                                                        {{vm.assay.featuresDataset.newField.name}} [ {{vm.assay.featuresDataset.newFieldQualifier[0]}} ]
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row m-t-md">
                                                <div class="col-md-12 ">
                                                    <div class="col-md-1"><a ng-click="vm.addField(vm.assay.featuresDataset);vm.addingNewField=false" class="btn btn-sm btn-info">Add Field</a></div>

                                                </div>
                                            </div>
                                        </form>
                                    </div>

                                    <!--FOO TABLE-->
                                    <table id="fe_template_tbl" class="footable table table-stripped toggle-arrow-tiny" data-page-size="15">
                                        <thead>
                                        <tr>
                                            <th data-toggle="true">Column</th>
                                            <th>Variable Name</th>
                                            <th>Include</th>
                                            <th data-hide="phone">Mandatory</th>
                                            <th data-hide="all">Description</th>
                                            <th data-hide="all">Controlled Vocabulary</th>
                                            <!--<th data-hide="all">Order</th>
                                            <th data-hide="all">Key Sequence</th>-->
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="var in vm.assay.featuresDataset.variables">
                                            <td>
                                                {{var.name}}
                                            </td>
                                            <td>
                                                {{var.label}}
                                            </td>
                                            <td>
                                                <!--<button type="button" class="btn btn-xs btn-primary" ng-model="var.isSelected" btn-checkbox>
                                                    {{var.isSelected ? 'Included' : 'Excluded'}}
                                                </button>-->
                                                <input  icheck type="checkbox"  ng-model="var.isSelected" >
                                            </td>
                                            <td>
                                                <input  icheck type="checkbox"  ng-model="var.isRequired" >
                                            </td>
                                            <td>
                                                {{var.description}}
                                            </td>
                                            <td>
                                                {{var.dictionaryName}}
                                            </td>
                                            <!--<td>
                                                <a href="#" e-ng-model="var.order" editable-text="var.order" buttons="no" blur="submit">{{var.order || "Undefined"}}</a>
                                                &lt;!&ndash;<input class="input-sm" style="width:25px" type="text" ng-model="var.order">&ndash;&gt;
                                            </td>
                                            <td>
                                                <a href="#" e-ng-model="var.sequence" editable-text="var.sequence" buttons="no" blur="submit">{{var.sequence || "Undefined"}}</a>
                                                &lt;!&ndash;<input class="input-sm" style="width:25px" type="text" ng-model="var.sequence">&ndash;&gt;
                                            </td>-->
                                        </tr>
                                        </tbody>
                                        <tfoot>
                                        <tr>
                                            <td colspan="6">
                                                <ul class="pagination pull-right"></ul>
                                            </td>
                                        </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>

                        </div>

                    </uib-tab>

                    <!--MEASURED DATA TAB-->
                    <uib-tab>
                        <uib-tab-heading class="assay-info" align="center">
                            <p class="tab-info">
                                Measured Observations Template <i class="fa fa-info"/>
                            </p>
                            <p class="assay-count">
                                {{ vm.assay.observationsDataset.name || 'No Template Selected' }}
                            </p>

                            <p class="tab-info text-left" >
                                A template for loading the assay measure data such as a data matrix for single measurements (e.g. normalized log ratio) or a data table for multiple measurements (e.g. CyTOF data)
                            </p>
                        </uib-tab-heading>

                        <div id="dataTemplate" class="animated fadeIn">

                            <!--CONTROLS-->
                            <div class="border-bottom p-w-sm text-right" style="margin: 0px -15px;">
                                    <span style="font-size:16px;margin-top:-5px;">
                                        <i class="p-xs fa fa-eye"> </i><i class="p-xs fa fa-download"> </i>
                                        <a ng-click="vm.deleteDS()"><i class="p-xs fa fa-trash"> </i></a>
                                        <a ng-init="vm.showDataTemplates = false" ng-click="vm.showDataTemplates = !vm.showDataTemplates; vm.loadAssayDataTemplates() ">
                                            <i uib-tooltip="Add Dataset" class="p-xs fa fa-edit"></i>
                                        </a>
                                    </span>
                            </div>

                            <!--Choose Template-->
                            <div uib-collapse="!vm.showDataTemplates" class="ibox-content" style="min-height: 250px;margin: 0px -15px; background-color: rgb(243, 243, 244);">
                                <div class="row">
                                    <div class="col-md-11">
                                        <h3>{{vm.assay.observationsDataset ? 'Change Template':'Choose Template'}}</h3>
                                    </div>
                                    <div class="col-md-1"> <span class="pull-right"><a ng-click="vm.showDataTemplates=false" class="btn btn-white btn-lg"><i class="fa fa-times"></i></a> </span></div>
                                </div>
                                <div class="row">
                                    <div class="col-md-7">
                                        <div class="row m-b-sm m-t-sm">

                                            <div class="col-md-12">
                                                <input ng-model="searchTemplate" type="text" placeholder="Search" class="input-sm form-control">
                                            </div>
                                        </div>

                                        <div class="ibox-content">
                                            <div class="activities-list" full-scroll>
                                                <div class="full-height-scroll">
                                                    <div class="feed-activity-list elements-list">
                                                        <div class="feed-element" ng-repeat="ds in vm.templates.data | filter:{name: searchTemplate}">
                                                            <a ng-click="vm.previewDataTemplate = ds">
                                                                <div>
                                                                    <small class="pull-right text-navy">{{ds.class}}</small>
                                                                    <strong>{{ds.name}} - ({{ds.code}})</strong>
                                                                    <div>{{ds.description}}</div>
                                                                    <small class="text-muted"><strong>Structure: </strong>{{ds.structure}}</small>
                                                                </div>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!--FIELD INFO-->
                                    <div ng-show="vm.previewDataTemplate" style="border-left: white 1px solid;" class=" m-b-sm m-t-sm col-md-5">
                                        <div class="ibox-title"><strong>{{vm.previewDataTemplate.name}} Template Fields</strong>
                                            <span class="pull-right"><a ng-click="vm.setDataDS(vm.previewDataTemplate);vm.showDataTemplates=false" class="btn btn-xs btn-primary">Choose Template</a></span>
                                        </div>
                                        <div class="ibox-content">
                                            <div class="activities-list" full-scroll>
                                                <div class="full-height-scroll">
                                                    <table class="table table-hover no-margins">
                                                        <thead>
                                                        <tr>
                                                            <th>Column</th>
                                                            <th>Name</th>
                                                            <th>Description</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        <tr ng-repeat="var in vm.previewDataTemplate.variables">
                                                            <td class="text-navy">
                                                                <small>{{var.name}}</small>
                                                            </td>
                                                            <td>{{var.label}}</td>
                                                            <td >{{var.description}}</td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--No Template Info-->
                            <div ng-hide="vm.assay.observationsDataset" class="ibox-content ibox-heading">
                                <h3>No Template Selected</h3>
                            </div>

                            <!--SUMMARY DATA-->
                            <div class=" m-b-sm m-t-sm border-bottom" ng-show="vm.assay.observationsDataset">
                                <dl class="dl-horizontal">
                                    <dt>Class</dt>
                                    <dd>{{vm.assay.observationsDataset.class}}</dd>
                                    <dt>Description</dt>
                                    <dd>{{vm.assay.observationsDataset.description}}</dd>
                                    <dt>Structure</dt>
                                    <dd>{{vm.assay.observationsDataset.structure}}</dd>
                                </dl>
                            </div>

                            <!--DATASET VARIABLES-->
                            <div ng-show="vm.assay.observationsDataset">
                                <div class="ibox-title">
                                    <h5>Select columns to include in this template</h5>
                                </div>

                                <!--FOO TABLE-->
                                <div class="ibox-content">
                                    <table id="data_template_tbl" class="footable table table-stripped toggle-arrow-tiny" load-when="vm.loaded" data-page-size="15">
                                        <thead>
                                        <tr>
                                            <th data-toggle="true">Column</th>
                                            <th>Variable Name</th>
                                            <th>Include</th>
                                            <th data-hide="phone">Mandatory</th>
                                            <th data-hide="all">Description</th>
                                            <th data-hide="all">Controlled Vocabulary</th>
                                            <th data-hide="all">Order</th>
                                            <th data-hide="all">Key Sequence</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="var in vm.assay.observationsDataset.variables">
                                            <td>
                                                {{var.name}}
                                            </td>
                                            <td>
                                                {{var.label}}
                                            </td>
                                            <td>
                                                <!--<button type="button" class="btn btn-xs btn-primary" ng-model="var.isSelected" btn-checkbox>
                                                    {{var.isSelected ? 'Included' : 'Excluded'}}
                                                </button>-->
                                                <input  icheck type="checkbox"  ng-model="var.isSelected" >
                                            </td>
                                            <td>
                                                <input  icheck type="checkbox"  ng-model="var.isRequired" >
                                            </td>
                                            <td>
                                                {{var.description}}
                                            </td>
                                            <td>
                                                {{var.dictionaryName}}
                                            </td>
                                            <td>
                                                <a href="#" e-ng-model="var.order" editable-text="var.order" buttons="no" blur="submit">{{var.order || "Undefined"}}</a>
                                                <!--<input class="input-sm" style="width:25px" type="text" ng-model="var.order">-->
                                            </td>
                                            <td>
                                                <a href="#" e-ng-model="var.sequence" editable-text="var.sequence" buttons="no" blur="submit">{{var.sequence || "Undefined"}}</a>
                                                <!--<input class="input-sm" style="width:25px" type="text" ng-model="var.sequence">-->
                                            </td>
                                        </tr>
                                        </tbody>
                                        <tfoot>
                                        <tr>
                                            <td colspan="6">
                                                <ul class="pagination pull-right"></ul>
                                            </td>
                                        </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </uib-tab>

                </uib-tabset>
            </div>

        </div>
    </div>
</div>
